# 程式檔案分析大綱

## 1. `AnalyzePage`

### 用途

- 呈現使用者的紀錄分析頁面，包含統計資料和圖表。

### 主要功能

- 根據 `username` 查詢資料庫，獲取使用者的數據。
- 檢查登入的使用者是否符合該頁面的使用者，若不符則返回 404。
- 顯示 `LeftMenu`、`StatCardGroup` 和 `Barchart` 等子組件。

### 技術細節

- 使用 Clerk 的 `auth` 函數來獲取當前使用者的 `userId`。
- 使用 Prisma 查詢使用者數據，並統計記錄數。
- 使用 `notFound()` 函數實現 404 頁面的導向。

---

## 2. `WeightChart`

### 用途

- 顯示使用者最近 20 天的體重變化趨勢。

### 主要功能

- 從伺服器獲取體重記錄，以折線圖展示每日體重數據。

### 技術細節

- 定義 `WeightRecord` 介面以約束 `data` 陣列結構。
- 使用 `useEffect` 來獲取數據並格式化日期顯示。
- 使用 `Recharts` 的 `LineChart` 繪製折線圖，並自訂 X 軸和 Y 軸的格式。

### 優化建議

- 增加 `loading` 狀態來提升使用者體驗。
- 在數據為空時顯示提示訊息。

---

## 3. `StatCardGroup`

### 用途

- 顯示訓練記錄的統計數據，如月總次數、月平均次數和當日運動時長。

### 主要功能

- 從伺服器獲取訓練數據，並將數據顯示在三個統計卡片中。

### 技術細節

- 使用 `useState` 管理卡片數據，`useEffect` 進行資料獲取。
- 將數據格式化並分配至各個卡片的欄位。

### 優化建議

- 合併 `setData` 操作，簡化程式碼並減少更新次數。

---

## 4. `CustomBarChart`

### 用途

- 顯示使用者最近 30 天的運動次數，包含深蹲、仰臥起坐和伏地挺身數據。

### 主要功能

- 從伺服器獲取運動記錄，並以柱狀圖展示每日運動次數。

### 技術細節

- 定義 `TrainingRecord` 介面以約束數據結構。
- 使用 `useEffect` 獲取並格式化訓練數據，並反轉日期順序以便圖表排序。
- 使用 `Recharts` 的 `BarChart` 繪製多組數據的柱狀圖。

### 優化建議

- 加入數據為空的提示訊息。
- 自訂工具提示以便清晰顯示運動次數。
